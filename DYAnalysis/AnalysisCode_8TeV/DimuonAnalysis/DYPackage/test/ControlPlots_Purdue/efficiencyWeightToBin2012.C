
int Find_Index( double muon_input, bool isPt )
{

   const int nptbins = 21;
   const int nrapbins = 8;
   double rap_bin[nrapbins] = {0.,0.2,0.4,0.7,1.1,1.9,2.4,1000.0};
   double pt_bin[nptbins] = {0.0,20.0,30.,35.,40.,45.,50.,55.,60.,65.,70.,75.,80.,85.,90.,100.,120.,150.,300.,600.,1000.};
   int Index = -1;

  if( isPt ) {
    for( int i = 0; i < nptbins-1; i++ ) {
      if( muon_input > pt_bin[i] && muon_input < pt_bin[i+1] ) {
             Index = i;
             break;
      }
      else if( muon_input > pt_bin[nptbins-1] ) Index = nptbins-2; //out of bounds
    }
    return Index;
  } else {
    for( int i = 0; i < nrapbins-1; i++ ) {
      if( muon_input > rap_bin[i] && muon_input < rap_bin[i+1] ) {
          Index = i;
          break;
       }
      else if( muon_input > rap_bin[nrapbins-1] ) Index = nrapbins-2; //out of bounds
    }
    return Index;
  }
}



double weight( double muon_pt, double muon_rap, double mass, bool isWeight) {
 int index_pt = -1;
 int index_rap = -1;

 const int nptbins = 21;
 const int nrapbins = 8;
 index_pt = Find_Index(muon_pt, true);
 index_rap = Find_Index(muon_rap, false);

double weights_fewz_1520[nrapbins-1][nptbins-1] = {{
1.00416, 1.34646, 1.6897, 1.38878, 2.01352, 2.31117, 2.83824, 3.07221, 1.96037, 2.76233, 1.64807, 3.1857, 5.51048, 1.52258, 5.99958, 3.08611, 4.82732, 1.79429, 0, 0}, {
1.00864, 1.46313, 1.70514, 1.72158, 1.99605, 2.19562, 1.63086, 3.72556, 3.41734, 2.69921, 1.19627, 3.59315, 0, 4.66132, 2.31093, 0, 1.70277, 0, 0.879525, 0}, {
1.01457, 1.37539, 1.40068, 1.73017, 2.41655, 1.50269, 2.41609, 3.90247, 2.89461, 1.984, 4.22626, 2.20561, 3.82164, 5.53993, 1.89213, 4.66614, 0, 5.21453, 0, 0}, {
1.01936, 1.31293, 1.34779, 1.62802, 1.50941, 1.9625, 2.26886, 2.59607, 1.64619, 2.6663, 3.25128, 3.00657, 5.29694, 4.23989, 5.97161, 5.64275, 2.8016, 1.17813, 0, 0}, {
1.01338, 1.28863, 1.44921, 1.50001, 1.69077, 2.32252, 2.03424, 2.1659, 2.65416, 2.93614, 2.65352, 2.9559, 1.88413, 5.40108, 2.82714, 2.6299, 4.81155, 4.67848, 0.587019, 0}, {
1.00491, 1.23724, 1.38738, 1.41711, 1.66604, 1.50775, 1.61374, 2.15697, 2.1939, 2.29321, 1.8458, 4.21097, 3.46865, 3.07175, 2.88818, 2.34384, 0, 4.01005, 0, 0}, {
0.992392, 1.10179, 1.16424, 1.27631, 1.61807, 1.39328, 1.4631, 1.88094, 1.76831, 1.9629, 1.8125, 1.3975, 2.64572, 3.92227, 1.47056, 3.4071, 2.46905, 0, 0, 0}};


double weights_fewz_2030[nrapbins-1][nptbins-1] = {{
0.966795, 1.08146, 1.17783, 1.2389, 1.2671, 1.337, 1.46826, 1.53753, 1.69101, 1.90694, 1.75862, 1.84123, 2.02089, 2.46507, 1.99676, 2.42811, 2.51464, 2.57894, 9.81246, 0}, {
0.966821, 1.07084, 1.20392, 1.22651, 1.27725, 1.35761, 1.55833, 1.5277, 1.63369, 1.89343, 1.89434, 2.09386, 1.91149, 2.22705, 2.04047, 2.35408, 2.84804, 3.06225, 8.13555, 0}, {
0.971295, 1.07558, 1.18809, 1.21033, 1.25954, 1.36813, 1.46697, 1.47801, 1.62936, 1.67328, 2.05463, 1.92814, 2.02834, 2.07286, 2.16174, 2.06113, 2.61071, 2.55462, 7.11472, 0}, {
0.97719, 1.08452, 1.20336, 1.23531, 1.29579, 1.36677, 1.50733, 1.50958, 1.65012, 1.76313, 1.83743, 1.8947, 1.84364, 2.12157, 2.07127, 2.18371, 2.38122, 2.91907, 5.53915, 24.2485}, {
0.985951, 1.10299, 1.2313, 1.26142, 1.31731, 1.41399, 1.51475, 1.51366, 1.63344, 1.77508, 1.84961, 1.82872, 1.98508, 1.87607, 1.88782, 2.08271, 2.38283, 2.29767, 3.44052, 0}, {
1.00139, 1.13358, 1.26055, 1.30091, 1.35507, 1.4015, 1.56959, 1.63962, 1.69208, 1.82881, 1.99774, 1.99627, 2.05123, 1.86841, 2.21083, 2.13477, 2.84815, 2.26473, 11.5107, 0}, {
1.01966, 1.1966, 1.32992, 1.35623, 1.44298, 1.516, 1.62573, 1.72958, 1.72485, 1.80241, 2.0048, 2.02067, 2.03064, 2.24097, 2.17355, 2.3538, 2.68364, 2.84224, 0, 0}};


double weights_fewz_3060[nrapbins-1][nptbins-1] = {{
1.00019, 0.961553, 0.984679, 1.03515, 1.05179, 1.07841, 1.13175, 1.23453, 1.12975, 1.18099, 1.13813, 1.28696, 1.39207, 1.27825, 1.40107, 1.44792, 1.59117, 1.54763, 4.28965, 0}, {
1.00316, 0.95746, 1.01436, 1.02028, 1.06503, 1.07198, 1.1163, 1.15781, 1.21926, 1.24923, 1.29625, 1.24856, 1.23657, 1.58808, 1.3749, 1.59685, 1.59133, 1.80805, 4.66198, 0}, {
1.00105, 0.963092, 0.999037, 1.00595, 1.04494, 1.05254, 1.15394, 1.17145, 1.16034, 1.23811, 1.1717, 1.14256, 1.19299, 1.24181, 1.48944, 1.50823, 1.61057, 1.75089, 4.95339, 0}, {
1.00952, 0.967643, 1.0294, 1.02102, 1.05859, 1.05685, 1.11382, 1.15422, 1.17062, 1.2124, 1.19927, 1.19439, 1.3836, 1.23024, 1.4784, 1.45075, 1.60368, 1.61005, 3.40739, 12.2983}, {
1.0186, 0.980607, 1.01867, 1.02512, 1.06044, 1.10319, 1.11848, 1.18239, 1.19943, 1.23007, 1.23308, 1.20419, 1.23912, 1.36312, 1.32622, 1.49572, 1.63333, 1.61027, 3.58052, 0}, {
1.02726, 1.00213, 1.05352, 1.0711, 1.0787, 1.10485, 1.1723, 1.20522, 1.23001, 1.30974, 1.2692, 1.24164, 1.26731, 1.45611, 1.3481, 1.57851, 1.61068, 1.60543, 3.99936, 0}, {
1.0448, 1.03419, 1.09082, 1.09112, 1.12025, 1.15318, 1.21638, 1.26016, 1.26781, 1.3679, 1.35831, 1.40795, 1.40254, 1.50698, 1.50665, 1.54957, 1.77361, 1.91552, 0, 0}};


double weights_fewz_60120[nrapbins-1][nptbins-1] = {{
1.0666, 1.00851, 0.992418, 0.957179, 0.970608, 0.978926, 0.979745, 0.992545, 1.00909, 1.00314, 1.02636, 1.07591, 1.07164, 1.10456, 1.09968, 1.09884, 1.23256, 1.18438, 1.49698, 2.6379}, {
1.06128, 1.00811, 0.988955, 0.965692, 0.97307, 0.971641, 0.990266, 0.997609, 0.986571, 1.01117, 1.02351, 1.04922, 1.10936, 1.12191, 1.11971, 1.1048, 1.24131, 1.19608, 1.56659, 2.23089}, {
1.06819, 1.00916, 0.993878, 0.96025, 0.970031, 0.976816, 0.995131, 1.00629, 1.00252, 1.02385, 1.03739, 1.04738, 1.07802, 1.09992, 1.09489, 1.11219, 1.2302, 1.1842, 1.49245, 2.33475}, {
1.06725, 1.00394, 0.99719, 0.966707, 0.971214, 0.975567, 0.977628, 1.00804, 1.00379, 1.01473, 1.03577, 1.06499, 1.07377, 1.10162, 1.09762, 1.12578, 1.2387, 1.21786, 1.58528, 3.08762}, {
1.07404, 1.01322, 1.00677, 0.977161, 0.986593, 0.993301, 1.00243, 1.01875, 1.01641, 1.03649, 1.06809, 1.05762, 1.0767, 1.1192, 1.12461, 1.13232, 1.27102, 1.24164, 1.6378, 2.60265}, {
1.08738, 1.01956, 1.01628, 0.990906, 1.00327, 1.01672, 1.01506, 1.0357, 1.02515, 1.05258, 1.06272, 1.0931, 1.10912, 1.15585, 1.13866, 1.16284, 1.27503, 1.25696, 1.61985, 0.492067}, {
1.08249, 1.02102, 1.02636, 1.00131, 1.01512, 1.02721, 1.04709, 1.06057, 1.08117, 1.09276, 1.10106, 1.12771, 1.13184, 1.19286, 1.17321, 1.19483, 1.32636, 1.26235, 1.263, 0}};


double weights_fewz_120300[nrapbins-1][nptbins-1] = {{
1.09228, 0.998013, 1.018, 0.971031, 0.97466, 0.842234, 0.991657, 0.941966, 0.929501, 0.81769, 0.921073, 0.810649, 1.01112, 0.979128, 1.03085, 1.04372, 1.02296, 0.957187, 1.0139, 0}, {
1.11102, 1.04406, 0.975035, 0.905751, 0.908007, 0.967548, 0.970756, 0.974605, 0.93018, 0.84391, 0.873699, 1.01165, 0.948635, 0.914441, 0.897196, 1.00976, 0.89909, 0.844045, 0.963149, 0.620792}, {
1.09225, 1.01919, 0.996127, 0.963403, 0.96099, 0.940063, 0.93447, 0.94661, 0.962165, 0.896828, 0.928552, 0.947227, 0.936115, 0.966597, 0.992136, 0.924646, 1.11261, 0.922474, 0.729502, 1.50627}, {
1.08944, 1.01376, 0.986641, 0.917256, 0.918029, 0.898567, 1.0111, 0.875106, 0.873727, 0.884566, 0.958532, 1.00803, 1.07565, 0.957755, 0.964595, 0.917043, 1.03213, 0.979115, 1.11416, 0}, {
1.09648, 1.0205, 1.0042, 0.953638, 0.931387, 0.932149, 0.920024, 0.928164, 0.92061, 0.967264, 0.975964, 0.937789, 0.93859, 1.00981, 0.951421, 0.945549, 1.07481, 0.939537, 1.08101, 0}, {
1.12189, 0.991039, 0.985581, 0.900807, 0.927545, 0.911767, 0.916305, 0.958536, 0.957582, 1.00404, 0.819441, 0.85792, 0.936968, 1.09091, 0.971074, 0.964622, 0.970776, 0.940051, 2.76658, 0}, {
1.11052, 0.982303, 0.928611, 0.943923, 0.890476, 0.913085, 0.837128, 0.938171, 0.95769, 0.930756, 0.84631, 0.954246, 0.99577, 0.943143, 0.952835, 1.18388, 0.989834, 0.884095, 0.188828, 0}};


double weights_fewz_3001500[nrapbins-1][nptbins-1] = {{
1.11916, 1.05288, 0.898581, 0.844122, 0.82833, 0.823275, 1.08695, 0.670818, 1.09271, 1.07259, 0.76756, 0.801273, 1.08496, 0.803065, 0.74775, 0.877829, 0.879094, 1.07114, 0.383978, 0.3931}, {
1.13056, 1.10449, 1.17832, 1.10731, 0.686359, 1.0081, 0.677495, 0.758849, 0.85119, 0.672292, 0.883737, 0.780991, 0.668899, 0.723599, 0.462506, 0.84355, 0.857404, 0.805732, 0.729053, 2.13662}, {
1.19266, 1.13606, 1.12006, 1.20277, 0.846993, 1.10362, 0.938725, 1.2129, 1.17904, 1.11191, 1.1206, 0.954558, 0.852126, 0.801655, 0.903889, 1.03144, 0.773651, 0.670457, 0.862678, 2.13123}, {
1.10609, 0.967908, 0.913327, 0.868782, 0.817142, 0.728328, 0.72763, 0.747084, 0.811055, 0.718103, 0.713464, 0.728693, 1.15077, 1.48091, 0.777279, 1.05269, 0.820902, 0.95098, 1.18311, 0.435937}, {
1.17703, 1.07603, 0.963876, 1.09404, 1.10924, 0.978322, 0.87632, 0.752015, 0.926805, 0.731931, 0.689159, 1.16942, 1.03399, 0.615171, 0.926701, 0.745423, 0.870425, 0.896293, 1.51011, 2.46508}, {
1.25008, 1.04018, 0.821679, 0.706569, 0.687062, 0.892858, 0.740394, 0.700806, 0.534156, 1.11408, 1.12822, 0.667278, 0.739863, 0.657903, 0.624306, 1.09569, 1.00116, 0.745523, 0.256876, 0}, {
1.28527, 1.24095, 0.645869, 0.865322, 0.847916, 0.669344, 0.72896, 0.89037, 0.488018, 1.22283, 1.02422, 0.859193, 72.5272, 0, 0.980242, 0.613628, 0, 0.309134, 0, 0}};


double weights_fewz_3045[nrapbins-1][nptbins-1] = {{
0.988287, 0.966047, 1.01353, 1.06405, 1.08943, 1.14255, 1.27333, 1.24523, 1.14396, 1.14034, 1.21727, 1.3922, 1.43688, 1.56037, 1.45562, 1.55316, 1.5378, 2.13568, 6.75466, 0}, {
0.99161, 0.969332, 1.03906, 1.06657, 1.07955, 1.15072, 1.19247, 1.18405, 1.3012, 1.37531, 1.38517, 1.40666, 1.49122, 2.01528, 1.38486, 1.79292, 1.9492, 2.12079, 8.7268, 0}, {
0.989549, 0.979114, 1.0256, 1.01713, 1.08857, 1.10967, 1.24745, 1.1922, 1.22311, 1.26562, 1.25072, 1.30241, 1.25245, 1.38711, 1.5716, 1.8225, 1.70261, 1.81934, 3.74848, 0}, {
0.998817, 0.981137, 1.06366, 1.04635, 1.11372, 1.11958, 1.21409, 1.19966, 1.26207, 1.27244, 1.32829, 1.3602, 1.40424, 1.50346, 1.65463, 1.59218, 1.72312, 1.97009, 4.52685, 0}, {
1.00816, 0.995653, 1.04138, 1.06178, 1.10758, 1.15238, 1.2, 1.2678, 1.2455, 1.26755, 1.2846, 1.41055, 1.40416, 1.49717, 1.4675, 1.65114, 1.73056, 1.82574, 3.55016, 0}, {
1.01896, 1.01502, 1.09685, 1.10516, 1.12748, 1.13742, 1.26379, 1.28736, 1.29438, 1.32146, 1.41432, 1.43422, 1.26466, 1.52356, 1.34909, 1.83321, 1.71123, 1.76123, 4.36676, 0}, {
1.03618, 1.0571, 1.12943, 1.14373, 1.17521, 1.21499, 1.29698, 1.32735, 1.30754, 1.48357, 1.45893, 1.55074, 1.51968, 1.62516, 1.67647, 1.74937, 2.03308, 2.12876, 0, 0}};


double weights_fewz_4560[nrapbins-1][nptbins-1] = {{
1.01776, 0.959136, 0.943107, 0.972433, 0.990694, 0.993054, 0.98933, 1.16569, 1.05751, 1.18306, 1.2169, 1.32517, 1.3648, 1.01301, 1.29692, 1.29342, 1.73583, 1.10859, 1.88833, 0}, {
1.02799, 0.932844, 0.976475, 0.936802, 1.0455, 0.964953, 1.02307, 1.04739, 1.07332, 1.06404, 1.26131, 1.02912, 1.06099, 1.1669, 1.28272, 1.31414, 1.30637, 1.65784, 3.66188, 0}, {
1.02235, 0.932475, 0.957668, 0.98781, 0.972154, 0.986619, 1.03698, 1.06518, 1.05565, 1.1478, 1.16231, 1.14604, 1.19744, 1.13999, 1.26244, 1.21207, 1.52486, 1.64002, 0, 0}, {
1.02781, 0.944684, 0.968546, 0.978594, 0.959462, 0.983604, 0.992482, 1.05523, 1.03791, 1.07478, 1.13235, 1.17416, 1.40494, 0.971715, 1.21538, 1.28435, 1.51424, 1.22826, 3.08049, 3.58378}, {
1.03652, 0.956853, 0.985532, 0.961986, 0.992729, 1.04367, 1.03591, 1.02139, 1.13777, 1.14924, 1.22895, 1.11463, 1.14092, 1.19502, 1.17148, 1.32274, 1.50285, 1.26535, 0.961285, 0}, {
1.04028, 0.981644, 0.992504, 1.02051, 1.00382, 1.07512, 1.06049, 1.08989, 1.08111, 1.26053, 1.10467, 1.0953, 1.41065, 1.33446, 1.37483, 1.27858, 1.51168, 1.52409, 1.69787, 0}, {
1.05171, 1.00065, 1.03494, 1.0075, 1.0428, 1.06696, 1.10964, 1.15033, 1.2322, 1.22957, 1.2221, 1.27415, 1.27685, 1.3057, 1.33244, 1.32314, 1.48907, 1.70717, 0, 0}};

double weights_fewz_6072[nrapbins-1][nptbins-1] = {{
1.07761, 0.934157, 0.956672, 0.944863, 0.995951, 0.964485, 0.887315, 0.879265, 1.00482, 0.969649, 1.13384, 1.01832, 0.926685, 1.11049, 0.919538, 1.15693, 1.10783, 1.14198, 1.37813, 0}, {1.04645, 0.928312, 0.942534, 0.949619, 0.910638, 1.03085, 0.971907, 0.919348, 1.06796, 1.12412, 0.993995, 1.24292, 1.09691, 0.878787, 1.14136, 1.29596, 1.17369, 1.11252, 1.80553, 0}, {1.05083, 0.956194, 0.947371, 0.881565, 0.95689, 0.977627, 0.966093, 0.984458, 0.958803, 1.0191, 0.983644, 0.926234, 1.18116, 1.06617, 1.00135, 1.19513, 1.17236, 1.16763, 3.32314, 1.362}, {1.08041, 0.943571, 0.959101, 0.939405, 0.95992, 0.947706, 1.03405, 0.982456, 0.963546, 0.932353, 1.00994, 1.06391, 1.13412, 1.16221, 1.05765, 1.12983, 1.15871, 1.33974, 1.61567, 0}, {1.03792, 1.00087, 1.32608, 1.18269, 1.17313, 1.1682, 1.11323, 1.13443, 1.17991, 1.13371, 1.286, 1.10408, 1.27168, 1.20084, 1.28636, 1.31934, 1.28857, 1.47149, 4.9482, 0}, {1.07154, 0.972952, 0.982377, 0.966839, 1.01474, 0.983433, 0.978091, 0.989419, 0.974042, 1.09152, 1.04181, 1.10047, 1.00884, 1.07373, 1.11966, 1.23123, 1.24254, 1.38351, 2.87256, 0}, {1.06578, 0.994999, 1.00027, 0.980491, 1.00496, 0.992416, 1.09608, 1.05667, 1.104, 1.1604, 1.2131, 1.10893, 1.1953, 1.13938, 1.07251, 1.2219, 1.46919, 1.17857, 0.148721, 0}};

/*
1.17761, 0.934157, 0.956672, 0.944863, 0.995951, 0.964485, 0.887315, 0.879265, 1.00482, 0.969649, 1.13384, 1.01832, 0.926685, 1.11049, 0.919538, 1.15693, 1.10783, 1.14198, 1.37813, 0}, {
1.04645, 0.928312, 0.942534, 0.949619, 0.910638, 1.03085, 0.971907, 0.919348, 1.06796, 1.12412, 0.993995, 1.24292, 1.09691, 0.878787, 1.14136, 1.29596, 1.17369, 1.11252, 1.80553, 0}, {
1.05083, 0.956194, 0.947371, 0.881565, 0.95689, 0.977627, 0.966093, 0.984458, 0.958803, 1.0191, 0.983644, 0.926234, 1.18116, 1.06617, 1.00135, 1.19513, 1.17236, 1.16763, 3.32314, 1.362}, {
1.18041, 0.943571, 0.959101, 0.939405, 0.95992, 0.947706, 1.03405, 0.982456, 0.963546, 0.932353, 1.00994, 1.06391, 1.13412, 1.16221, 1.05765, 1.12983, 1.15871, 1.33974, 1.61567, 0}, {
1.03792, 1.50087, 1.32608, 1.18269, 1.17313, 1.1682, 1.11323, 1.13443, 1.17991, 1.13371, 1.286, 1.10408, 1.27168, 1.20084, 1.28636, 1.31934, 1.28857, 1.47149, 4.9482, 0}, {
1.07154, 0.972952, 0.982377, 0.966839, 1.01474, 0.983433, 0.978091, 0.989419, 0.974042, 1.09152, 1.04181, 1.10047, 1.00884, 1.07373, 1.11966, 1.23123, 1.24254, 1.38351, 2.87256, 0}, {
1.06578, 0.994999, 1.00027, 0.980491, 1.00496, 0.992416, 1.09608, 1.05667, 1.104, 1.1604, 1.2131, 1.10893, 1.1953, 1.13938, 1.07251, 1.2219, 1.46919, 1.17857, 0.148721, 0}};
*/

double weights_fewz_106120[nrapbins-1][nptbins-1] = {{
1.05875, 1.01193, 1.02993, 0.939267, 0.976529, 0.947734, 0.939627, 0.992071, 0.88548, 0.871746, 0.944994, 1.0731, 0.969593, 1.24709, 0.975739, 1.03632, 1.14127, 1.12242, 1.4614, 0}, {
1.06971, 1.00658, 1.03122, 0.992112, 0.989606, 1.10822, 0.988502, 0.893806, 0.927539, 1.00976, 0.966847, 1.01022, 1.05622, 1.07156, 0.999446, 1.08246, 1.12414, 1.17209, 1.10602, 0}, {
1.07953, 1.01552, 0.989706, 1.0061, 0.995138, 0.948787, 0.968876, 0.986198, 1.08061, 1.02936, 1.04584, 0.993288, 0.894439, 0.952469, 1.06174, 0.975938, 1.16312, 1.15012, 1.01288, 0}, {
1.08012, 1.01944, 0.973647, 0.944252, 0.974805, 0.91962, 0.944114, 0.943453, 1.01609, 0.915318, 1.03569, 0.942355, 0.94966, 1.06469, 1.00633, 1.11681, 1.14823, 1.02933, 0.892791, 0.48281}, {
1.07954, 1.01136, 0.991145, 0.968893, 0.970483, 1.02022, 0.991046, 0.945839, 0.934984, 1.04181, 0.980923, 1.00479, 1.04022, 1.04997, 1.0458, 1.1149, 1.16377, 1.1131, 1.36021, 0}, {
1.08324, 1.01999, 1.03904, 0.989113, 1.07359, 1.04055, 0.90662, 0.986513, 0.914199, 1.03616, 1.00168, 1.03984, 0.991378, 1.00784, 1.15544, 1.10135, 1.12373, 1.35761, 1.57517, 0}, {
1.09173, 1.00791, 1.00209, 0.993995, 0.975309, 0.999788, 0.989677, 1.04392, 0.982507, 1.15342, 1.05276, 1.02922, 1.2619, 1.1285, 1.24255, 1.17908, 1.20954, 1.04626, 0, 0}};


double weights_fewz_120200[nrapbins-1][nptbins-1] = {{
1.08648, 0.995927, 1.02626, 0.997055, 0.985968, 0.830446, 1.00019, 0.958475, 0.991928, 0.897126, 0.90654, 0.839846, 1.00197, 1.00133, 1.0861, 1.0459, 1.04032, 0.987855, 0.897923, 0}, {
1.10379, 1.06023, 0.980886, 0.93374, 0.894623, 1.00966, 0.973931, 0.95706, 0.954393, 0.868201, 0.919577, 1.02176, 0.97446, 0.909271, 0.919722, 1.07873, 0.873126, 0.875059, 0.934669, 0.352009}, {
1.07794, 1.02341, 1.01028, 0.961949, 0.994313, 0.937159, 0.934666, 0.956779, 0.986334, 0.874407, 0.917937, 0.97424, 0.970426, 1.01654, 1.0276, 0.929814, 1.15009, 0.985713, 0.796958, 1.24385}, {
1.07979, 1.01099, 0.980992, 0.91306, 0.938874, 0.903882, 1.01351, 0.893591, 0.870522, 0.906189, 0.956953, 1.0473, 1.07548, 0.992913, 1.01823, 0.949882, 1.05635, 1.01633, 1.42104, 0}, {
1.08719, 1.02842, 1.01182, 0.971948, 0.958272, 0.951827, 0.939879, 0.948629, 0.941134, 0.997094, 0.972118, 0.958613, 0.945908, 1.02399, 0.947501, 0.967407, 1.09243, 0.965332, 1.24071, 0}, {
1.11281, 0.999359, 1.01682, 0.906168, 0.94475, 0.934203, 0.940376, 0.976295, 0.995564, 1.03652, 0.82753, 0.884937, 0.961326, 1.16382, 0.990352, 1.00754, 1.00253, 0.995507, 3.34617, 0}, {
1.09894, 0.998164, 0.953474, 0.973722, 0.916097, 0.940834, 0.852112, 0.95876, 1.00401, 0.952451, 0.888519, 0.981643, 1.08631, 0.964843, 1.02566, 1.27521, 0.999714, 0.872378, 0.171713, 0}};


  //coarse
/*
    if (mass > 15 && mass < 20) {
      return weights_fewz_1520[index_rap][index_pt];
    } else if (mass > 20 && mass < 30) {
      return weights_fewz_2030[index_rap][index_pt];
    } else if (mass > 30 && mass < 60) {
      return weights_fewz_3060[index_rap][index_pt];
    } else if (mass > 60 && mass < 120) {
      return weights_fewz_60120[index_rap][index_pt];
    } else if (mass > 120 && mass < 300) {
      return weights_fewz_120300[index_rap][index_pt];
    } else if (mass > 300 && mass < 1500) {
      return weights_fewz_3001500[index_rap][index_pt];
    }
*/

    if (mass >= 15 && mass < 20) {
      return weights_fewz_1520[index_rap][index_pt];
    } else if (mass >= 20 && mass < 30) {
      return weights_fewz_2030[index_rap][index_pt];
    } else if (mass >= 30 && mass < 45) {
      return weights_fewz_3045[index_rap][index_pt];
    } else if (mass >= 45 && mass < 60) {
      return weights_fewz_4560[index_rap][index_pt];
    } else if (mass >= 60 && mass < 72) {
      return weights_fewz_6072[index_rap][index_pt];
    } else if (mass >= 72 && mass < 106) {
      return weights_fewz_60120[index_rap][index_pt];
    } else if (mass >= 106 && mass < 120) {
      return weights_fewz_106120[index_rap][index_pt];
    } else if (mass >= 120 && mass < 200) {
      return weights_fewz_120200[index_rap][index_pt];
    } else if (mass >= 200 && mass < 300) {
      return weights_fewz_120300[index_rap][index_pt];
    } else if (mass >= 300 && mass < 1500) {
      return weights_fewz_3001500[index_rap][index_pt];
    }

    return 0.;
}

