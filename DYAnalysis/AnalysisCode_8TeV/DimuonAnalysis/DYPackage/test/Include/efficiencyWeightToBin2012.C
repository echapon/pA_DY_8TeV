int Find_Index( double muon_input, bool isPt )
{
   const int nptbins = 7;
   const int nabsetabins = 6;
   Double_t abseta_bin[nabsetabins] = {0,0.8,1.4442,1.566,2.0,2.4};

   Double_t pt_bin[nptbins] = {10,15,20,30,40,50,500};

   int Index = -1;

  if( isPt ) {
    for( int i = 0; i < nptbins-1; i++ ) {
      if( muon_input >= pt_bin[i] && muon_input < pt_bin[i+1] ) {
             Index = i;
             break;
      }
      //upper bin protection
      else if( muon_input >= pt_bin[nptbins-1] ) Index = nptbins-2; //out of bounds
    }
    return Index;
  } else {
    for( int i = 0; i < nabsetabins-1; i++ ) {
      if( muon_input >= abseta_bin[i] && muon_input < abseta_bin[i+1] ) {
          Index = i; 
          break;
       }
    }
    return Index;
  }
}


double correction_lepton( double muon_pt, double muon_abseta) {
 int index_pt = -1;
 int index_abseta = -1;

 const int nptbins = 7;
 const int nabsetabins = 6;
 index_pt = Find_Index(muon_pt, true);
 index_abseta = Find_Index(muon_abseta, false);

 double data_SF[nptbins-1][nabsetabins-1] = {{
0.87156, 0.87156, 0.883974, 0.943306, 0.943306}, {
0.93815, 0.93815, 0.746221, 0.908318, 0.908318}, {
0.950625, 0.962693, 0.89446, 0.936725, 0.893572}, {
0.966991, 0.972498, 0.936802, 0.953156, 0.91335}, {
0.971245, 0.975228, 0.958726, 0.96012, 0.930933}, {
0.975287, 0.976778, 0.948681, 0.963537, 0.931882}};

/* ID
0.386742, 0.472945, 0.333131, 0.231625, 0.271439}, {
0.586561, 0.596205, 0.360493, 0.386774, 0.419076}, {
0.759097, 0.715115, 0.488266, 0.582059, 0.606028}, {
0.848751, 0.819963, 0.623663, 0.699396, 0.696767}, {
0.883379, 0.869114, 0.703766, 0.774734, 0.756785}, {
0.88586, 0.874889, 0.718684, 0.802525, 0.770328}};
*/
/*HLT
0.860516, 0.88601, 0.877301, 0.945044, 0.923946}, {
0.941985, 0.95068, 0.948529, 0.976207, 0.968826}, {
0.98132, 0.982502, 0.983577, 0.99166, 0.98696}, {
0.991874, 0.992502, 0.990728, 0.995831, 0.992683}, {
0.993788, 0.994454, 0.993691, 0.997228, 0.994747}, {
0.993609, 0.994136, 0.993206, 0.998077, 0.99684}};
*/

 double mc_SF[nptbins-1][nabsetabins-1] = {{
0.897742, 0.897742, 0.714779, 0.852879, 0.852879}, {
0.938116, 0.938116, 0.766888, 0.896098, 0.896098}, {
0.968302, 0.968297, 0.876614, 0.947918, 0.891796}, {
0.978509, 0.979044, 0.948939, 0.960293, 0.90896}, {
0.981179, 0.982644, 0.970668, 0.968276, 0.925418}, {
0.985213, 0.985849, 0.972719, 0.973467, 0.933916}};
/* ID
0.442894, 0.464249, 0.271022, 0.254392, 0.274064}, {
0.616145, 0.60878, 0.370315, 0.427419, 0.416708}, {
0.764644, 0.743246, 0.524899, 0.613555, 0.580642}, {
0.845093, 0.837428, 0.658646, 0.720625, 0.67617}, {
0.878808, 0.880392, 0.726068, 0.778991, 0.739094}, {
0.883765, 0.8888, 0.73111, 0.804614, 0.760012}};
*/
/* HLT
0.836513, 0.861986, 0.880952, 0.932529, 0.934041}, {
0.924737, 0.943196, 0.953451, 0.976157, 0.973512}, {
0.975539, 0.98349, 0.981139, 0.989484, 0.981735}, {
0.989687, 0.993608, 0.988854, 0.995003, 0.987147}, {
0.993451, 0.996324, 0.992227, 0.997004, 0.991745}, {
0.994413, 0.997046, 0.994167, 0.997858, 0.993202}};
*/
     return data_SF[index_pt][index_abseta]/mc_SF[index_pt][index_abseta];
}
